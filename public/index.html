<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XQuests - Tweet. Engage. Earn.</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Social media engagement platform that allows users to participate in challenges, earn cryptocurrency rewards, and connect their social media accounts.">
    <meta name="keywords" content="XQuests, Twitter, X, social media, cryptocurrency, ALGO, Algorand, challenges, rewards, engagement">
    <meta name="author" content="XQuests">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://xquests.site/">
    <meta property="og:title" content="XQuests - Tweet. Engage. Earn.">
    <meta property="og:description" content="Participate in challenges, earn cryptocurrency rewards, and connect your social media accounts.">
    <meta property="og:image" content="https://xquests.site/assets/images/icon.png">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://xquests.site/">
    <meta property="twitter:title" content="XQuests - Tweet. Engage. Earn.">
    <meta property="twitter:description" content="Participate in challenges, earn cryptocurrency rewards, and connect your social media accounts.">
    <meta property="twitter:image" content="https://xquests.site/assets/images/icon.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon.png">
    <link rel="apple-touch-icon" href="/assets/images/icon.png">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#1D9BF0">
    <meta name="msapplication-TileColor" content="#1D9BF0">
    
    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://images.pexels.com">
    <link rel="preconnect" href="https://api.dicebear.com">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #000000 0%, #1e293b 100%);
            color: #ffffff;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .loading-container {
            text-align: center;
            max-width: 400px;
            padding: 40px 20px;
            z-index: 9999;
            position: relative;
        }
        
        .logo-container {
            margin-bottom: 32px;
            position: relative;
        }
        
        .logo {
            width: 120px;
            height: 120px;
            margin: 0 auto;
            background: linear-gradient(135deg, #1D9BF0 0%, #06B6D4 100%);
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            font-weight: bold;
            color: white;
            box-shadow: 0 20px 40px rgba(29, 155, 240, 0.3);
            animation: pulse 2s ease-in-out infinite;
            position: relative;
            overflow: hidden;
        }
        
        .logo::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shine 3s ease-in-out infinite;
        }
        
        .logo-text {
            position: relative;
            z-index: 2;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        
        .app-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #1D9BF0, #06B6D4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .app-subtitle {
            font-size: 16px;
            color: #94a3b8;
            margin-bottom: 40px;
            font-weight: 500;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(29, 155, 240, 0.3);
            border-top: 3px solid #1D9BF0;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 16px;
            color: #e2e8f0;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .loading-subtext {
            font-size: 14px;
            color: #64748b;
            line-height: 1.5;
        }
        
        .error-container {
            display: none;
            text-align: center;
            padding: 20px;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 12px;
            margin-top: 20px;
        }
        
        .error-title {
            color: #ef4444;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .error-message {
            color: #fca5a5;
            font-size: 14px;
            margin-bottom: 16px;
        }
        
        .retry-button {
            background: #1D9BF0;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s ease;
        }
        
        .retry-button:hover {
            background: #1a8cd8;
        }
        
        .features {
            margin-top: 32px;
            text-align: left;
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .feature {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            font-size: 14px;
            color: #94a3b8;
        }
        
        .feature-icon {
            width: 20px;
            height: 20px;
            background: #1D9BF0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 12px;
        }
        
        /* App container styling */
        #root {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000000;
            z-index: 1;
        }
        
        /* Hide loading screen when app is ready */
        .app-ready .loading-container {
            display: none;
        }
        
        @media (max-width: 480px) {
            .loading-container {
                padding: 20px;
            }
            
            .logo {
                width: 100px;
                height: 100px;
                font-size: 40px;
            }
            
            .app-title {
                font-size: 28px;
            }
            
            .app-subtitle {
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="loading-container" id="loadingContainer">
        <div class="logo-container">
            <div class="logo">
                <span class="logo-text">X</span>
            </div>
        </div>
        
        <h1 class="app-title">XQuests</h1>
        <p class="app-subtitle">Tweet. Engage. Earn.</p>
        
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading your experience...</div>
        <div class="loading-subtext">Connecting to the future of social engagement</div>
        
        <div class="error-container" id="errorContainer">
            <div class="error-title">Loading Error</div>
            <div class="error-message">The app failed to load. Please check your connection and try again.</div>
            <button class="retry-button" onclick="window.location.reload()">Retry</button>
        </div>
        
        <div class="features">
            <div class="feature">
                <div class="feature-icon">üê¶</div>
                <span>Connect your X account</span>
            </div>
            <div class="feature">
                <div class="feature-icon">üí∞</div>
                <span>Earn ALGO rewards</span>
            </div>
            <div class="feature">
                <div class="feature-icon">üèÜ</div>
                <span>Complete challenges</span>
            </div>
            <div class="feature">
                <div class="feature-icon">üìà</div>
                <span>Track your progress</span>
            </div>
        </div>
    </div>

    <!-- App will be injected here by Expo -->
    <div id="root"></div>

    <script>
        // Loading timeout and error handling
        let loadingTimeout;
        let appLoaded = false;
        let swRegistered = false;
        
        // Set a timeout to show error if app doesn't load
        loadingTimeout = setTimeout(() => {
            if (!appLoaded) {
                document.getElementById('errorContainer').style.display = 'block';
                console.error('App loading timeout - check network connection');
            }
        }, 15000); // 15 second timeout
        
        // Function to hide loading screen when app is ready
        window.hideLoadingScreen = function() {
            appLoaded = true;
            clearTimeout(loadingTimeout);
            
            const loadingContainer = document.getElementById('loadingContainer');
            if (loadingContainer) {
                loadingContainer.style.transition = 'opacity 0.5s ease-out';
                loadingContainer.style.opacity = '0';
                setTimeout(() => {
                    loadingContainer.style.display = 'none';
                    document.body.classList.add('app-ready');
                }, 500);
            }
        };
        
        // Enhanced app ready detection
        function checkAppReady() {
            const rootElement = document.getElementById('root');
            if (rootElement && rootElement.children.length > 0) {
                console.log('App content detected, hiding loading screen');
                window.hideLoadingScreen();
                return true;
            }
            return false;
        }
        
        // Multiple detection methods for app readiness
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM Content Loaded');
            
            // Check immediately
            if (checkAppReady()) return;
            
            // Check periodically
            const checkInterval = setInterval(() => {
                if (checkAppReady()) {
                    clearInterval(checkInterval);
                }
            }, 100);
            
            // Fallback timeout
            setTimeout(() => {
                clearInterval(checkInterval);
                if (!appLoaded) {
                    console.log('Fallback: hiding loading screen after timeout');
                    window.hideLoadingScreen();
                }
            }, 5000);
        });
        
        // Service Worker Registration for PWA (with error handling)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('‚úÖ SW registered successfully:', registration);
                        swRegistered = true;
                    })
                    .catch((registrationError) => {
                        console.log('‚ö†Ô∏è SW registration failed (this is OK):', registrationError);
                        // Don't treat SW registration failure as a critical error
                        swRegistered = false;
                    });
            });
        }
        
        // Handle online/offline status
        window.addEventListener('online', () => {
            console.log('üì∂ App is online');
            document.body.style.filter = 'none';
        });
        
        window.addEventListener('offline', () => {
            console.log('üìµ App is offline');
            document.body.style.filter = 'grayscale(50%)';
        });
        
        // Performance monitoring
        window.addEventListener('load', () => {
            if (window.performance) {
                const loadTime = window.performance.timing.loadEventEnd - window.performance.timing.navigationStart;
                console.log('‚è±Ô∏è Page load time:', loadTime + 'ms');
            }
        });
        
        // Framework ready hook integration
        window.frameworkReady = function() {
            console.log('üöÄ Framework ready signal received');
            setTimeout(() => {
                window.hideLoadingScreen();
            }, 500);
        };
        
        // Error handling for uncaught errors
        window.addEventListener('error', (event) => {
            console.error('‚ùå Uncaught error:', event.error);
            if (!appLoaded) {
                document.getElementById('errorContainer').style.display = 'block';
            }
        });
        
        // Handle unhandled promise rejections
        window.addEventListener('unhandledrejection', (event) => {
            console.error('‚ùå Unhandled promise rejection:', event.reason);
        });
    </script>
</body>
</html>